import{d as g,h as M,t as a,y as j,i,b as s,S as d,F as N,e as W,s as P,w as q,a as O,f as H}from"./index-hslFEwih.js";var J=a('<div class="px-4 py-2 bg-red-50 border-b border-red-200 text-red-600 text-sm">'),R=a('<div class="flex flex-col items-center"><svg class="w-6 h-6 text-gray-400"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg><span class="text-sm text-gray-500 mt-1">Click to upload or drag and drop'),T=a('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600">'),V=a('<div class="grid grid-cols-4 gap-4">'),Y=a('<div class="text-center py-12 text-gray-500"><svg class="mx-auto h-12 w-12 text-gray-400"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><p class=mt-2>No media files yet'),K=a('<div class="fixed inset-0 z-50 overflow-y-auto"role=dialog aria-modal=true><div class="flex min-h-full items-center justify-center p-4 text-center"><div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"aria-hidden=true></div><div class="relative w-full max-w-3xl bg-white rounded-lg shadow-xl"><div class="flex items-center justify-between px-4 py-3 border-b border-gray-200"><h3 class="text-lg font-semibold text-gray-900">Select Media</h3><button class="text-gray-400 hover:text-gray-600"aria-label=Close><svg class="w-6 h-6"fill=none stroke=currentColor viewBox="0 0 24 24"aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="px-4 py-3 border-b border-gray-200 bg-gray-50"><label class="flex items-center justify-center w-full h-20 px-4 transition bg-white border-2 border-gray-300 border-dashed rounded-lg appearance-none cursor-pointer hover:border-gray-400 focus:outline-none"><input type=file class=hidden accept=image/*></label></div><div class="px-4 py-4 max-h-96 overflow-y-auto">'),Q=a('<div class="flex items-center gap-2"><div class="animate-spin rounded-full h-5 w-5 border-b-2 border-primary-600"aria-hidden=true></div><span class="text-sm text-gray-500">Uploading...'),X=a('<button class="relative group aspect-square bg-gray-100 rounded-lg overflow-hidden border-2 border-transparent hover:border-gray-300 transition-colors"><img class="w-full h-full object-cover"><div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-opacity flex items-end p-2"><span class="text-xs text-white truncate drop-shadow-md">');const Z=["image/jpeg","image/png","image/gif","image/webp"];function te(l){const[b,m]=g([]),[y,x]=g(!0),[U,w]=g(!1),[$,f]=g(null);M(()=>{if(!l.isOpen)return;const e=t=>{t.key==="Escape"&&(t.preventDefault(),l.onClose())};document.addEventListener("keydown",e),q(()=>document.removeEventListener("keydown",e))});async function A(){x(!0);try{const e=await O.media.list();m(e.data)}catch(e){console.error("Failed to load media:",e)}finally{x(!1)}}M(()=>{l.isOpen&&A()});async function F(e){if(f(null),!Z.includes(e.type)){f("Invalid file type. Only JPEG, PNG, GIF, and WebP are allowed.");return}w(!0);try{const c={...await O.media.upload(e),createdAt:new Date().toISOString()};m(u=>[c,...u])}catch(t){console.error("Upload failed:",t),f(t instanceof Error?t.message:"Upload failed. Please try again.")}finally{w(!1)}}function I(e){l.onSelect(e),l.onClose()}return(()=>{var e=K(),t=e.firstChild,c=t.firstChild,u=c.nextSibling,_=u.firstChild,B=_.firstChild,D=B.nextSibling,p=_.nextSibling,k=p.firstChild,C=k.firstChild,E=p.nextSibling;return j(c,"click",l.onClose,!0),j(D,"click",l.onClose,!0),i(u,s(d,{get when(){return $()},get children(){var n=J();return i(n,$),n}}),p),i(k,s(d,{get when(){return!U()},get fallback(){return Q()},get children(){return R()}}),C),C.addEventListener("change",n=>{const r=n.target.files?.[0];r&&F(r)}),i(E,s(d,{get when(){return y()},get children(){return T()}}),null),i(E,s(d,{get when(){return!y()},get children(){return[(()=>{var n=V();return i(n,s(N,{get each(){return b()},children:r=>(()=>{var h=X(),v=h.firstChild,G=v.nextSibling,z=G.firstChild;return h.$$click=()=>I(r),i(z,()=>r.alt||r.filename),W(o=>{var S=`/api/media/${r.id}`,L=r.alt||r.filename;return S!==o.e&&P(v,"src",o.e=S),L!==o.t&&P(v,"alt",o.t=L),o},{e:void 0,t:void 0}),h})()})),n})(),s(d,{get when(){return b().length===0},get children(){return Y()}})]}}),null),e})()}H(["click"]);export{te as M};
