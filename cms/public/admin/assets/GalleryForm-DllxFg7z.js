import{u as Ie,g as Ee,d as n,c as Me,h as ne,t as b,i as r,b as c,S as y,F as je,e as u,s as Ge,a as j,f as De}from"./index-q5GqSJ5T.js";import{s as Te}from"./slugify-CLfdhm_z.js";import{M as Le}from"./MediaPicker-DWWExyiy.js";var Pe=b('<div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm mb-6">'),Be=b("<div class=space-y-2>"),Fe=b('<div class="text-center py-8 text-gray-500 border-2 border-dashed border-gray-200 rounded-lg"><svg class="mx-auto h-8 w-8 text-gray-400"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><p class=mt-2>No images yet'),Ue=b('<div class="p-8 max-w-4xl"><div class="page-header flex justify-between items-center"><div><h1 class=page-title></h1><p class=page-subtitle></p></div><div class="flex gap-2"><button class="btn btn-secondary">Cancel</button><button class="btn btn-primary"></button></div></div><form class=space-y-6><div class="grid grid-cols-3 gap-6"><div class="col-span-2 space-y-6"><div class="card p-6 space-y-4"><div><label for=title class=label>Title</label><input id=title type=text required class=input placeholder="Gallery title"></div><div><label for=slug class=label>Slug</label><div class="flex items-center"><span class="inline-flex items-center px-3 rounded-l-lg border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm">/</span><input id=slug type=text required class="input rounded-l-none"placeholder=gallery-slug></div></div><div><label for=description class=label>Description</label><textarea id=description rows=4 class=input placeholder="Describe this gallery"></textarea></div></div></div><div class=space-y-6><div class="card p-6 space-y-4"><h3 class="font-semibold text-gray-900">Status</h3><select class=input><option value=draft>Draft</option><option value=published>Published</option></select></div></div></div><div class="card p-6"><div class="flex items-center justify-between mb-4"><h3 class="font-semibold text-gray-900">Images (<!>)</h3><button type=button class="btn btn-primary btn-sm">Add Images'),Ne=b('<div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg"><span class="text-sm text-gray-500 w-6"></span><img alt class="w-16 h-16 object-cover rounded"><div class=flex-1><p class="text-sm text-gray-600">Image </p></div><div class="flex items-center gap-1"><button type=button class="p-1 text-gray-500 hover:text-gray-700 disabled:opacity-30"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M5 15l7-7 7 7"></path></svg></button><button type=button class="p-1 text-gray-500 hover:text-gray-700 disabled:opacity-30"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M19 9l-7 7-7-7"></path></svg></button><button type=button class="p-1 text-red-500 hover:text-red-700"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M6 18L18 6M6 6l12 12">');function Re(){const f=Ie(),G=Ee(),o=()=>f.id!==void 0,[h,D]=n(""),[T,_]=n(""),[L,P]=n(""),[B,F]=n("draft"),[i,$]=n([]),[U,N]=n(!1),[O,q]=n(""),[de,w]=n(!1),[oe]=Me(()=>o()?f.id:null,async e=>e?j.galleries.get(e):null);ne(()=>{const e=oe();e&&!h()&&(D(e.title),_(e.slug),P(e.description),F(e.status),$(e.images))}),ne(()=>{if(!o()){const e=Te(h(),{lower:!0,strict:!0});_(e)}});async function A(e){e.preventDefault(),q(""),N(!0);try{const t={title:h(),slug:T(),description:L(),status:B(),images:i().map((s,a)=>({...s,order:a}))};o()&&f.id?await j.galleries.update(f.id,t):await j.galleries.create(t),G("/galleries")}catch(t){q(t instanceof Error?t.message:"Failed to save gallery")}finally{N(!1)}}function ce(e){const t={id:crypto.randomUUID(),mediaId:e.id,order:i().length};$([...i(),t]),w(!1)}function ue(e){$(i().filter(t=>t.id!==e))}function R(e,t){const s=i().findIndex(p=>p.id===e);if(s===-1||t==="up"&&s===0||t==="down"&&s===i().length-1)return;const a=[...i()],m=t==="up"?s-1:s+1,x=a[s],g=a[m];x&&g&&([a[s],a[m]]=[g,x]),$(a)}return(()=>{var e=Ue(),t=e.firstChild,s=t.firstChild,a=s.firstChild,m=a.nextSibling,x=s.nextSibling,g=x.firstChild,p=g.nextSibling,S=t.nextSibling,z=S.firstChild,H=z.firstChild,ge=H.firstChild,V=ge.firstChild,pe=V.firstChild,J=pe.nextSibling,K=V.nextSibling,ve=K.firstChild,be=ve.nextSibling,fe=be.firstChild,Q=fe.nextSibling,he=K.nextSibling,$e=he.firstChild,W=$e.nextSibling,me=H.nextSibling,xe=me.firstChild,ye=xe.firstChild,X=ye.nextSibling,C=z.nextSibling,_e=C.firstChild,k=_e.firstChild,we=k.firstChild,Y=we.nextSibling;Y.nextSibling;var Se=k.nextSibling;return r(a,()=>o()?"Edit Gallery":"New Gallery"),r(m,()=>o()?"Update gallery content":"Create a new photo gallery"),g.$$click=()=>G("/galleries"),p.$$click=A,r(p,c(y,{get when(){return!U()},fallback:"Saving...",get children(){return o()?"Update Gallery":"Create Gallery"}})),r(e,c(y,{get when(){return O()},get children(){var l=Pe();return r(l,O),l}}),S),S.addEventListener("submit",A),J.$$input=l=>D(l.currentTarget.value),Q.$$input=l=>_(l.currentTarget.value),W.$$input=l=>P(l.currentTarget.value),X.addEventListener("change",l=>F(l.currentTarget.value)),r(k,()=>i().length,Y),Se.$$click=()=>w(!0),r(C,c(y,{get when(){return i().length>0},get children(){var l=Be();return r(l,c(je,{get each(){return i()},children:(v,I)=>(()=>{var Z=Ne(),ee=Z.firstChild,te=ee.nextSibling,le=te.nextSibling,ie=le.firstChild;ie.firstChild;var Ce=le.nextSibling,E=Ce.firstChild,M=E.nextSibling,ke=M.nextSibling;return r(ee,()=>I()+1),r(ie,()=>v.mediaId,null),E.$$click=()=>R(v.id,"up"),M.$$click=()=>R(v.id,"down"),ke.$$click=()=>ue(v.id),u(d=>{var se=`/api/media/${v.mediaId}`,re=I()===0,ae=I()===i().length-1;return se!==d.e&&Ge(te,"src",d.e=se),re!==d.t&&(E.disabled=d.t=re),ae!==d.a&&(M.disabled=d.a=ae),d},{e:void 0,t:void 0,a:void 0}),Z})()})),l}}),null),r(C,c(y,{get when(){return i().length===0},get children(){return Fe()}}),null),r(e,c(Le,{get isOpen(){return de()},onClose:()=>w(!1),onSelect:ce,multiple:!0}),null),u(()=>p.disabled=U()),u(()=>J.value=h()),u(()=>Q.value=T()),u(()=>W.value=L()),u(()=>X.value=B()),e})()}De(["click","input"]);export{Re as default};
